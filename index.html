<!DOCTYPE html>
<html>
<head>
    <title>Webcams Buenos Aires</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        #webcams { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .webcam { border: 1px solid #ddd; padding: 15px; border-radius: 5px; }
        img { max-width: 100%; height: auto; }
    </style>
</head>
<body>
    <h1>Webcams en Buenos Aires</h1>
    <div id="webcams"></div>

    <script>
        async function getWebcams() {
            const apiKey = "dxDS5A1vfB7PTIRIhqPQ0COHnn9BWNms";
            const lat = -34.6131;
            const lon = -58.3772;
            const radius = 50;
            const limit = 10;
            
            try {
                // Usamos un proxy CORS para evitar el bloqueo
                const proxyUrl = "https://api.allorigins.win/raw?url=";
                const apiUrl = `https://api.windy.com/api/webcams/v2/list/nearby=${lat},${lon},${radius}/limit=${limit}?key=${apiKey}`;
                
                const response = await fetch(proxyUrl + encodeURIComponent(apiUrl));
                const data = await response.json();
                
                if (data.status === "OK") {
                    displayWebcams(data.result.webcams);
                } else {
                    document.getElementById('webcams').innerHTML = 
                        `<p style="color: red">Error: ${data.message || "Error desconocido"}</p>`;
                }
            } catch (error) {
                document.getElementById('webcams').innerHTML = 
                    `<p style="color: red">Error al cargar: ${error.message}</p>`;
            }
        }

        function displayWebcams(webcams) {
            const container = document.getElementById('webcams');
            container.innerHTML = '';
            
            if (!webcams || webcams.length === 0) {
                container.innerHTML = '<p>No se encontraron webcams en esta área</p>';
                return;
            }
            
            webcams.forEach(webcam => {
                const webcamDiv = document.createElement('div');
                webcamDiv.className = 'webcam';
                
                const title = `<h3>${webcam.title || 'Webcam'}</h3>`;
                const location = `<p>${webcam.location?.city || ''} ${webcam.location?.region || ''}</p>`;
                const image = webcam.image?.daylight?.preview ? 
                    `<img src="${webcam.image.daylight.preview}" alt="${webcam.title}">` : 
                    '<p>Imagen no disponible</p>';
                const link = webcam.player?.day?.url ? 
                    `<a href="${webcam.player.day.url}" target="_blank">Ver en vivo</a>` : 
                    '<p>Enlace no disponible</p>';
                
                webcamDiv.innerHTML = `${title}${location}${image}${link}`;
                container.appendChild(webcamDiv);
            });
        }

        // Cargar webcams al abrir la página
        window.onload = getWebcams;
    </script>
</body>
</html>
